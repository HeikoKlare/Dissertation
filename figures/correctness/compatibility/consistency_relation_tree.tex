\newcommand{\hdistance}{11.5em}
\newcommand{\classwidth}{6em}

\begin{tikzpicture}

% Person
\umlclassvarwidth{person}{}{Person\sameheight}{
firstname\\
lastname
}{\classwidth}


\umlclassvarwidth[,right=\hdistance of person.center, anchor=center]{resident}{}{Resident\sameheight}{
name
}{\classwidth}

% Employee
\umlclassvarwidth[,right=\hdistance of resident.center, anchor=center]{employee}{}{Employee\sameheight}{
name
}{\classwidth}


% CONSISTENCY RELATIONS
\draw[directed consistency relation] (resident.west-|person.east) -- node[pos=0, above right] {$p$} node[pos=0.5, below] {$\consistencyrelation{CR}{1}$} node[pos=1, above left] {$r$} (resident.west);
\draw[directed consistency relation] (resident) -- node[pos=0, above right] {$r$} node[below] {$\consistencyrelation{CR}{2}$} node[pos=1, above left] {$e$} (employee);


\node[consistency related element, below left=1em and 0em of resident.south, anchor=north, inner sep=0em] {
$\begin{aligned}
    \consistencyrelation{CR}{1} =\; & \setted{\tupled{p,r} \mid r.name = \mathvariable{p.firstname} + "\text{\textvisiblespace}" + \mathvariable{p.lastname}}\\ %[0.3em]
    \consistencyrelation{CR}{2} =\; & \setted{\tupled{r,e} \mid \mathvariable{r.name} = \mathvariable{e.name}}
\end{aligned}$
};

\end{tikzpicture}