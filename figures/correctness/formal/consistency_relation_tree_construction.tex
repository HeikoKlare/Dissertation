\newcommand{\hdistance}{16em}
\newcommand{\objectwidth}{8em}

\begin{tikzpicture}[
    consistency process/.style={consistency relation, dashed}
]

% Person
\umlobjectvarwidth{person}{}{Person\sameheight}{
firstname = "Alice"\\
lastname = "Do"
}{\objectwidth}

% Employee
\umlobjectvarwidth[,above right=4em and \hdistance of person.center, anchor=south]{employee}{}{Employee\sameheight}{
name = "Alice Do"
}{\objectwidth}

\umlobjectvarwidth[,right=\hdistance of person.south, anchor=south]{resident}{}{Resident\sameheight}{
name = "Alice Do"
}{\objectwidth}


% CONSISTENCY RELATIONS
\draw[consistency relation] ([yshift=-1em]resident.west-|person.east) -- node[pos=0, above right] {$p$} node[pos=0.5, below] {$\consistencyrelation{CR}{1}$} node[pos=1, above left] {$r$} ([yshift=-1em]resident.west);
\draw[consistency relation] (resident.north) -- node[pos=0, above left] {$r$} node[right, align=left] {$\consistencyrelation{CR}{2}$} node[pos=1, below left] {$e$} (employee.south);

\node[consistency related element, below left=1em and 2em of person.south west, anchor=north west] {
$\begin{aligned}
    \consistencyrelation{CR}{1} =\; & \setted{\tupled{p,r} \mid r.name = p.firstname + "\textnormal{\textvisiblespace}" + p.lastname}\\[0.3em]
    \consistencyrelation{CR}{2} =\; & \setted{\tupled{r,e} \mid r.name = e.name}
\end{aligned}$
};

% CONSISTENCY PROCESS
\draw[consistency process] ([xshift=-2.5em]person.west) -- node[above] {\textbf{(1)}} (person.west);
\draw[consistency process] ([yshift=1em]resident.west-|person.east) -- node[above] {\textbf{(2)}} ([yshift=1em]resident.west);
\draw[consistency process] ([xshift=-2em]resident.north) -- node[left] {\textbf{(3)}} ([xshift=-2em]employee.south);

\end{tikzpicture}