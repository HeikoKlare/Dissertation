%% Dissertationsvorlage
%%
%% Karlsruhe Institute of Technology
%% Institute for Program Structures and Data Organization
%% Chair for Software Design and Quality (SDQ)
%%
%% Dr.-Ing. Erik Burger
%% burger@kit.edu
%%
%% Siehe https://sdqweb.ipd.kit.edu/wiki/Dokumentvorlagen

%% Dokumentoptionen

% Für das Proposal bzw. vorgelegte Fassung (DIN A4):
%
% \documentclass{sdqdiss-a4}

% Für die Druckfassung im Format von KIT Scientific Publishing 
% das Format (DIN A5 oder 17 cm × 24 cm) und den Umfang des Dokuments eintragen:
% 
% +---------------+-----------------------+
% | Format        | Option                |
% +---------------+-----------------------+
% | DIN A5        | a5format  (Standard)  |
% | 17 cm × 24 cm | 17x24format           |
% +---------------+-----------------------+
%
% +---------------+-----------------------+
% | Seitenzahl    | Option                |
% +---------------+-----------------------+
% | < 200         | smalldiss             |
% | 200–399       | mediumdiss (Standard) |
% | > 400         | largediss             |
% +---------------+-----------------------+
%
% z.B. \documentclass[largediss, 17x24format]{sdqdiss-ksp}

\RequirePackage[table]{xcolor} % Necessary for sdqdiss-a4 to avoid options clash
\documentclass[
    largediss, % > 400 pages in A5 KSP format
    fleqn, % left-aligned formula, passed to loading of amsmath
]{sdqdiss-ksp}
\RequirePackage{enumitem} % Necessary because sdqdiss-a4 template does not load it
\RequirePackage{scrhack} % Circumvent warning due to incompatibility of float, listings etc. with current KOMAscript

% Benötigt für die Typewriter-Schriftart
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}

% Für Sprachumschaltung
\usepackage[ngerman,english]{babel}
\usepackage{csquotes}

% Tolerate slightly overfull horizontal boxes
\hfuzz=1pt

\usepackage{templates/complete_template}

% Overwrite template: Improve indent for lists of figures/tables, otherwise, e.g., "11.10." has not enough space
\makeatletter
\renewcommand\l@figure{\@dottedtocline{1}{0em}{2.6em}}
\renewcommand\l@table{\@dottedtocline{1}{0em}{2.6em}}
\renewcommand\l@lstlisting{\@dottedtocline{1}{0em}{2.6em}}
\makeatother

% Für kurzes Inhaltsverzeichnis
\RequirePackage{setspace}
\RequirePackage[tight]{shorttoc}

%%% TOGGLES
\newtoggle{showCopiedFrom}
\toggletrue{showCopiedFrom}
\newtoggle{showMarginNotes}
\togglefalse{showMarginNotes}

% Abstract
\newcommand{\Abstract}[1][Abstract]{\chapter*{#1}\addcontentsline{toc}{chapter}{#1}\markboth{#1}{#1}} 


%%
%% Beginn des Dokuments
%%

%\title{Preserving Consistency of Multiple Model with Networks of Transformations}
%\title{Transformation Networks for Consistent Evolution of Multiple Heterogeneous Models}
%\title{Building Transformation Networks for Consistent Evolution\\ of Multiple Models}
\title{Building Transformation Networks for Consistent Evolution\\ of Interrelated Models}
\author{Heiko Klare}
\subject{}

\subtitle{
\vskip2em
zur Erlangung des akademischen Grades eines\\[1em]
{\Large Doktors der Ingenieurwissenschaften /}\\[0.5em]
{\Large Doktors der Naturwissenschaften}\\[1em]
der KIT-Fakultät für Informatik\\
des Karlsruher Instituts für Technologie (KIT)\\[.5em]
{vorgelegte}\\[.3em]
{\Large Dissertation}
}

\author{\normalsize{von}\\
{\LARGE Heiko Klare}\\
\normalsize{aus Höxter}
}

\publishers{%
\flushleft\small
Tag der mündlichen Prüfung: XX. Monat XXXX\\
Erster Gutachter: Prof.\ Dr.\ Ralf H.\ Reussner\\
Zweiter Gutachter: Prof.\ Dr.\ Colin Atkinson\\
}

\date{}

\includeonly{
    sections/1_prologue/110_introduction,
    sections/1_prologue/120_foundations,
    sections/1_prologue/130_networks,
    sections/3_correctness/3100_correctness,
    sections/3_correctness/3200_compatibility,
    sections/3_correctness/3300_synchronization,
    sections/3_correctness/3400_orchestration,
    sections/3_correctness/3500_errors,
    sections/3_correctness/3600_evaluation,
    sections/6_quality/610_classification,
    sections/6_quality/620_improvement,
    sections/6_quality/630_language,
    sections/6_quality/640_evaluation,
    sections/9_epilogue/910_relatedwork,
    sections/9_epilogue/920_futurework,
    sections/9_epilogue/930_conclusions,
    sections/X_appendix/X10_compatibility_proofs,
    sections/X_appendix/X20_verifiability,
}

%%
%% Titelseite
%%

\begin{document}
\maketitle

%%
%% Abstract/Zusammenfassung
%%
% start with roman page numbers
\frontmatter

%% Englischer Abstract
\selectlanguage{english}
\Abstract{
    \input{sections/0_abstract/010_english.tex}
}

%% Deutsche Zusammenfassung
\selectlanguage{ngerman}
\Abstract[Zusammenfassung]{
    \input{sections/0_abstract/020_deutsch.tex}
}

% Sprachumschaltung
\selectlanguage{english}

%%
%% Inhaltsverzeichnis
%%
%% TODO: ShortToC only for A4 version
\begingroup
\setlength{\lineskiplimit}{-12pt}
\renewcommand{\baselinestretch}{0.25}
\shorttoc{Contents Overview}{0}
\endgroup

\cleardoublepage
\setcounter{tocdepth}{2}
\tableofcontents

\renewcommand\lstlistlistingname{List of Listings}
\newcommand{\listdefinitionname}{List of Definitions}
\newcommand{\listinsightname}{List of Insights}
\newcommand{\listsalgorithmandlistingname}{Lists of Algorithms and Listings}
\cleardoublepage
\listoffigures
%\addcontentsline{toc}{chapter}{\listfigurename}
\cleardoublepage
\listoftables
%\addcontentsline{toc}{chapter}{\listtablename}
\cleardoublepage
\listofalgorithms
%\addcontentsline{toc}{chapter}{\listsalgorithmandlistingname}
%\addcontentsline{toc}{chapter}{\listalgorithmname}
{\let\cleardoublepage\relax\lstlistoflistings} % put listings on same page as algorithms
%\addcontentsline{toc}{chapter}{\lstlistlistingname}
\cleardoublepage
\listoftheorems[ignoreall,show={definition,theorem,lemma,corallary,claim,proposition}]
%\addcontentsline{toc}{chapter}{\listtheoremname}
% \cleardoublepage
% \listoftheorems[ignoreall,show={definition},
    %title={\listdefinitionname},
    %swapnumber
% ]
%\addcontentsline{toc}{chapter}{\listdefinitionname}
% \cleardoublepage
% \listoftheorems[ignoreall,show={theorem,lemma,corollary,claim,proposition},
    %swapnumber
% ]
%\addcontentsline{toc}{chapter}{\listtheoremname}
\cleardoublepage
\listoftheorems[ignoreall,show={insight},
    title={\listinsightname},
    %swapnumber
]
%\addcontentsline{toc}{chapter}{\listinsightname}
\printglossaries

%%
%% Inhalt
%%
% restart with Arabic page numbers
\mainmatter

% Need to redefine the ref names here, as something overwrites them before
\def\chapterautorefname{Chapter}
\def\sectionautorefname{Section}
\def\subsectionautorefname{Subsection}
\def\subsubsectionautorefname{Subsection}
\def\paragraphautorefname{Paragraph}

\input{sections/100_prologue}
\input{sections/300_correctness}
\input{sections/600_quality}
\input{sections/900_epilogue}
\input{sections/X00_appendix}

\defbibnote{myprenote}{\emph{The titles of most entries are hyperlinks resolving the DOIs or pointing to other online sources for the entries.}}
{
\sloppy
\printbibliography[heading=bibintoc,prenote=myprenote]
%\printbibliography[heading=bibintoc,notcategory=ownpublications,prenote=myprenote]
%\textbf{Own Publications}
%\printbibliography[title={Own Publications},heading=none,category=ownpublications]
}

\end{document}